# PRINS
PRoject-Inference-and-Stitch (PRINS); Scalable model inference for system logs


## Paper
> Shin, D., Bianculli, D. & Briand, L. PRINS: scalable model inference for component-based system logs. Empir Software Eng 27, 87 (2022). https://doi.org/10.1007/s10664-021-10111-4



## Authors
- Donghwan Shin (d.shin@sheffield.ac.uk)
- Domenico Bianculli (domenico.bianculli@uni.lu)
- Lionel Briand (lbriand@uottawa.ca)


## Prerequisites
* python 3.7+ (tested with 3.7 and 3.9)
* graphviz 10+ (tested with 10.0.1)
* JDK 8+ (for MINT, tested with openjdk 17.0.10)


## Install

Firstly, to render generated models in PDF, you must install `dot`. 
Try the following command to check if `dot` is installed:
```shell script
dot -V
```

If `dot` is not installed, you can install it by following [this page](https://www.graphviz.org/download/).
On Windows, you can follow the [installation procedure](https://forum.graphviz.org/t/new-simplified-installation-procedure-on-windows/224).

Second, initialize python's virtual environment & install required packages:
```shell script
python3 -m venv venv
source venv/bin/activate  # venv should be activated during the execution of PRINS
pip install -r requirements.txt
```

Finally, you must have JDK to run MINT, which is used as a backend for PRINS. 
Try the following command to check if JDK is installed:
```shell script
java -version
```

If JDK is not installed, you can install it by following [this page](https://openjdk.org/install/).


## Test PRINS

To check if PRINS is correctly installed, you can run the following command:
```shell script
python3 -m unittest discover -s tests
```
All 50 tests should pass without any error.


## Run PRINS

* Input: a structured (preprocessed) log file (csv); for each log entry, the following should be provided at minimum:
  * `logID`: log id (if logs are collected for multiple executions)
  * `lineID`: line number of each log; a single log message (line) has the same id
  * `component`: component (name or id)
  * `tid`: event template id
  * `values`: runtime values for the variable parts of the template (currently not used, but even `[]` should be provided in the csv file)
* Output: a pdf file showing the system model (in the form of EFSM)
  * By default, PRINS keeps all the intermediate outputs for debugging
* Command to run:
  * `python3 run_PRINS.py Hadoop dataset_example/Hadoop/Hadoop_preprocessed_logs.csv`


## Detailed Parameters
```shell script
(venv) donghwan.shin@MF0032 PRINS % python run_PRINS.py -h
usage: run_PRINS.py [-h] [--output_dir OUTPUT_DIR] [--save_files]
                    [--timeout TIMEOUT] [--num_workers NUM_WORKERS]
                    [--ignore_values] [--det DET]
                    system structured_log_csv

positional arguments:
  system                System name
  structured_log_csv    Structured log file (csv) generated by LogPrep

optional arguments:
  -h, --help            show this help message and exit
  --output_dir OUTPUT_DIR
                        Output directory (default=./output/{SYSTEM})
  --save_files          Set this if you want to save result files
                        (default=True)
  --timeout TIMEOUT     MINT timeout (sec) (default=3600)
  --num_workers NUM_WORKERS
                        Number of processes in multiprocessing (default=4)
  --ignore_values       Set this if you want to ignore values (default=False)
  --det DET             (postprocessing) determinization technique
                        (default=heuristic)
```


## Licensing

PRINS is Â© 2021 University of Luxembourg and licensed under the GPLv3 license.

Please read `PRINS licensing information.txt` for details.
